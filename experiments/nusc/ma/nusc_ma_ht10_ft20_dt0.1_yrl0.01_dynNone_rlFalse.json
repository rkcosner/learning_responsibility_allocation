{
    "registered_name": "nusc_agent_predictor",
    "train": {
        "logging": {
            "terminal_output_to_txt": true,
            "log_tb": false,
            "log_wandb": true,
            "wandb_project_name": "tbsim",
            "log_every_n_steps": 10,
            "flush_every_n_steps": 100
        },
        "save": {
            "enabled": true,
            "every_n_steps": 1000,
            "best_k": 10,
            "save_best_rollout": false,
            "save_best_validation": true
        },
        "rollout": {
            "save_video": true,
            "enabled": false,
            "every_n_steps": 5000,
            "warm_start_n_steps": 1
        },
        "training": {
            "batch_size": 100,
            "num_steps": 200000,
            "num_data_workers": 18
        },
        "validation": {
            "enabled": true,
            "batch_size": 32,
            "num_data_workers": 6,
            "every_n_steps": 500,
            "num_steps_per_epoch": 50
        },
        "parallel_strategy": "ddp_spawn",
        "on_ngc": false,
        "avdata_source_train": "nusc-train",
        "avdata_source_valid": "nusc-val",
        "avdata_source_root": "nusc",
        "dataset_path": "SET-THIS-THROUGH-TRAIN-SCRIPT-ARGS",
        "datamodule_class": "UnifiedDataModule"
    },
    "env": {
        "name": "nusc",
        "rasterizer": {
            "raster_size": 224,
            "pixel_size": 0.5,
            "ego_center": [
                -0.5,
                0.0
            ]
        },
        "data_generation_params": {
            "other_agents_num": 20,
            "max_agents_distance": 30,
            "yaw_correction_speed": 1.0
        },
        "simulation": {
            "distance_th_close": 30,
            "num_simulation_steps": 50,
            "start_frame_index": 0
        }
    },
    "algo": {
        "name": "agent_predictor",
        "eval_class": "HierAgentAware",
        "model_architecture": "resnet18",
        "map_feature_dim": 256,
        "history_num_frames": 10,
        "history_num_frames_ego": 10,
        "history_num_frames_agents": 10,
        "future_num_frames": 20,
        "step_time": 0.1,
        "render_ego_history": false,
        "decoder": {
            "layer_dims": [
                128,
                128
            ],
            "state_as_input": true
        },
        "dynamics": {
            "type": null,
            "max_steer": 0.5,
            "max_yawvel": 6.283185307179586,
            "acce_bound": [
                -10,
                8
            ],
            "ddh_bound": [
                -6.283185307179586,
                6.283185307179586
            ],
            "max_speed": 40.0
        },
        "spatial_softmax": {
            "enabled": false,
            "kwargs": {
                "num_kp": 32,
                "temperature": 1.0,
                "learnable_temperature": false
            }
        },
        "loss_weights": {
            "prediction_loss": 1.0,
            "goal_loss": 0.0,
            "collision_loss": 0.0,
            "yaw_reg_loss": 0.01,
            "lane_reg_loss": 0.5,
            "GAN_loss": 0.5
        },
        "optim_params": {
            "policy": {
                "learning_rate": {
                    "initial": 0.001,
                    "decay_factor": 0.1,
                    "epoch_schedule": []
                },
                "regularization": {
                    "L2": 0.0
                }
            },
            "GAN": {
                "learning_rate": {
                    "initial": 0.0003,
                    "decay_factor": 0.1,
                    "epoch_schedule": []
                },
                "regularization": {
                    "L2": 0.0
                }
            }
        },
        "agent_feature_dim": 128,
        "global_feature_dim": 128,
        "context_size": [
            30,
            30
        ],
        "goal_conditional": true,
        "goal_feature_dim": 32,
        "use_rotated_roi": false,
        "use_transformer": false,
        "roi_layer_key": "layer2",
        "use_GAN": false,
        "history_conditioning": false
    },
    "eval": {
        "name": null,
        "env": "nusc",
        "dataset_path": null,
        "eval_class": "",
        "seed": 0,
        "num_scenes_per_batch": 4,
        "num_scenes_to_evaluate": 100,
        "num_episode_repeats": 1,
        "start_frame_index_each_episode": null,
        "seed_each_episode": null,
        "ego_only": false,
        "ckpt_root_dir": "checkpoints/",
        "experience_hdf5_path": null,
        "results_dir": "results/",
        "ckpt": {
            "policy": {
                "ngc_job_id": "",
                "ckpt_key": ""
            },
            "planner": {
                "ngc_job_id": "",
                "ckpt_key": ""
            },
            "predictor": {
                "ngc_job_id": "",
                "ckpt_key": ""
            },
            "cvae_metric": {
                "ngc_job_id": "",
                "ckpt_key": ""
            },
            "occupancy_metric": {
                "ngc_job_id": "",
                "ckpt_key": ""
            }
        },
        "policy": {
            "mask_drivable": true,
            "num_plan_samples": 50,
            "num_action_samples": 10,
            "pos_to_yaw": true,
            "yaw_correction_speed": 1.0,
            "diversification_clearance": null,
            "sample": false,
            "cost_weights": {
                "collision_weight": 10.0,
                "lane_weight": 1.0,
                "likelihood_weight": 0.0,
                "progress_weight": 0.0
            }
        },
        "metrics": {
            "compute_analytical_metrics": true,
            "compute_learned_metrics": false
        },
        "perturb": {
            "enabled": false,
            "OU": {
                "theta": 0.8,
                "sigma": [
                    0.1,
                    0.2,
                    0.5,
                    1.0,
                    2.0,
                    4.0
                ],
                "scale": [
                    1.0,
                    1.0,
                    0.2
                ]
            }
        },
        "nusc": {
            "eval_scenes": [
                0,
                10,
                20,
                30,
                40,
                50,
                60,
                70,
                80,
                90
            ],
            "n_step_action": 5,
            "num_simulation_steps": 200,
            "skip_first_n": 0
        },
        "l5kit": {
            "eval_scenes": [
                9058,
                5232,
                14153,
                8173,
                10314,
                7027,
                9812,
                1090,
                9453,
                978,
                10263,
                874,
                5563,
                9613,
                261,
                2826,
                2175,
                9977,
                6423,
                1069
            ],
            "n_step_action": 5,
            "num_simulation_steps": 200,
            "skip_first_n": 1,
            "skimp_rollout": false
        }
    },
    "name": "nusc_ma_ht10_ft20_dt0.1_yrl0.01_dynNone_rlFalse",
    "root_dir": "ma_rasterized_trained_models/",
    "seed": 1,
    "devices": {
        "num_gpus": 1
    }
}