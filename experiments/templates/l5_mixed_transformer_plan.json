{
    "registered_name": "l5_mixed_transformer_plan",
    "train": {
        "logging": {
            "terminal_output_to_txt": true,
            "log_tb": false,
            "log_wandb": true,
            "wandb_project_name": "tbsim",
            "log_every_n_steps": 10,
            "flush_every_n_steps": 100
        },
        "save": {
            "enabled": true,
            "every_n_steps": 10000,
            "best_k": 5
        },
        "render": {
            "on_screen": false,
            "to_video": true
        },
        "rollout": {
            "enabled": true,
            "num_episodes": 4,
            "num_scenes": 25,
            "every_n_steps": 1000,
            "warm_start_n_steps": 1
        },
        "training": {
            "batch_size": 100,
            "num_steps": 2000000,
            "num_data_workers": 4
        },
        "validation": {
            "enabled": true,
            "batch_size": 100,
            "num_data_workers": 4,
            "every_n_steps": 2000,
            "num_steps_per_epoch": 100
        },
        "parallel_strategy": "ddp_spawn",
        "dataset_path": "YOUR-DATASET-PATH",
        "dataset_valid_key": "scenes/validate.zarr",
        "dataset_train_key": "scenes/train.zarr",
        "dataset_meta_key": "meta.json",
        "datamodule_class": "L5MixedDataModule"
    },
    "env": {
        "name": "my_env",
        "rasterizer": {
            "semantic_map_key": "semantic_map/semantic_map.pb",
            "dataset_meta_key": "meta.json",
            "filter_agents_threshold": 0.5,
            "disable_traffic_light_faces": false,
            "raster_size": [
                224,
                224
            ],
            "pixel_size": [
                0.5,
                0.5
            ],
            "ego_center": [
                0.25,
                0.5
            ],
            "map_type": "semantic_debug",
            "satellite_map_key": "aerial_map/aerial_map.png",
            "set_origin_to_bottom": true
        },
        "data_generation_params": {
            "other_agents_num": 20,
            "max_agents_distance": 50,
            "lane_params": {
                "max_num_lanes": 15,
                "max_points_per_lane": 5,
                "max_points_per_crosswalk": 5,
                "max_retrieval_distance_m": 35,
                "max_num_crosswalks": 20
            }
        },
        "simulation": {
            "distance_th_far": 30,
            "distance_th_close": 15,
            "disable_new_agents": true,
            "num_simulation_steps": 50,
            "start_frame_index": 0
        }
    },
    "algo": {
        "name": "TransformerPred",
        "model_architecture": "Factorized",
        "history_num_frames": 8,
        "history_num_frames_ego": 8,
        "history_num_frames_agents": 8,
        "future_num_frames": 10,
        "step_time": 0.2,
        "N_t": 4,
        "N_a": 3,
        "d_model": 512,
        "d_ff": 2048,
        "head": 8,
        "dropout": 0.1,
        "XY_step_size": [
            0.1,
            0.1
        ],
        "weights_scaling": [
            1.0,
            1.0,
            1.0
        ],
        "ego_weight": 1.0,
        "all_other_weight": 0.5,
        "disable_other_agents": false,
        "disable_map": false,
        "global_head_dropout": 0.0,
        "map_channels": 3,
        "hidden_channels": [
            10,
            20,
            10,
            3
        ],
        "ROI_outdim": 12,
        "output_size": 512,
        "patch_size": [
            15,
            35,
            25,
            25
        ],
        "kernel_size": [
            5,
            5,
            5,
            3
        ],
        "strides": [
            1,
            1,
            1,
            1
        ],
        "input_size": [
            224,
            224
        ],
        "try_to_use_cuda": true,
        "render_ego_history": false,
        "optim_params": {
            "policy": {
                "learning_rate": {
                    "initial": 0.001,
                    "decay_factor": 0.1,
                    "epoch_schedule": []
                },
                "regularization": {
                    "L2": 0.0
                }
            }
        }
    },
    "name": "test",
    "root_dir": "TransformerPred_trained_models/",
    "seed": 1,
    "devices": {
        "num_gpus": 1
    }
}