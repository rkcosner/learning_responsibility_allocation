{
    "registered_name": "l5_mixed_tree_vae_plan",
    "train": {
        "logging": {
            "terminal_output_to_txt": true,
            "log_tb": false,
            "log_wandb": true,
            "wandb_project_name": "tbsim",
            "log_every_n_steps": 10,
            "flush_every_n_steps": 100
        },
        "save": {
            "enabled": true,
            "every_n_steps": 1000,
            "best_k": 10,
            "save_best_rollout": true,
            "save_best_validation": true
        },
        "render": {
            "on_screen": false,
            "to_video": true
        },
        "rollout": {
            "enabled": false,
            "num_episodes": 10,
            "num_scenes": 3,
            "every_n_steps": 500,
            "warm_start_n_steps": 1,
            "n_step_action": 10
        },
        "training": {
            "batch_size": 64,
            "num_steps": 200000,
            "num_data_workers": 8
        },
        "validation": {
            "enabled": true,
            "batch_size": 32,
            "num_data_workers": 6,
            "every_n_steps": 500,
            "num_steps_per_epoch": 50
        },
        "parallel_strategy": "ddp_spawn",
        "on_ngc": false,
        "dataset_path": "/home/yuxiaoc/repos/l5kit/prediction-dataset",
        "dataset_valid_key": "scenes/validate.zarr",
        "dataset_train_key": "scenes/train.zarr",
        "dataset_meta_key": "meta.json",
        "datamodule_class": "L5MixedDataModule",
        "dataset_mode": "agents"
    },
    "env": {
        "name": "l5_mixed",
        "rasterizer": {
            "semantic_map_key": "semantic_map/semantic_map.pb",
            "dataset_meta_key": "meta.json",
            "filter_agents_threshold": 0.5,
            "disable_traffic_light_faces": false,
            "raster_size": [
                224,
                224
            ],
            "pixel_size": [
                0.5,
                0.5
            ],
            "ego_center": [
                0.25,
                0.5
            ],
            "map_type": "py_semantic",
            "satellite_map_key": "aerial_map/aerial_map.png",
            "set_origin_to_bottom": true
        },
        "generate_agent_obs": true,
        "data_generation_params": {
            "other_agents_num": 20,
            "max_agents_distance": 50,
            "lane_params": {
                "max_num_lanes": 15,
                "max_points_per_lane": 5,
                "max_points_per_crosswalk": 5,
                "max_retrieval_distance_m": 35,
                "max_num_crosswalks": 20,
                "lane_interp_step_size": 5.0
            },
            "rasterize_agents": false,
            "vectorize_agents": true,
            "vectorize_lane": false
        },
        "simulation": {
            "distance_th_far": 50,
            "distance_th_close": 50,
            "disable_new_agents": false,
            "num_simulation_steps": 50,
            "start_frame_index": 0
        }
    },
    "algo": {
        "name": "l5_rasterized_tree_vae",
        "model_architecture": "resnet18",
        "map_feature_dim": 256,
        "history_num_frames": 5,
        "history_num_frames_ego": 5,
        "history_num_frames_agents": 5,
        "future_num_frames": 50,
        "step_time": 0.1,
        "render_ego_history": false,
        "decoder": {
            "layer_dims": [],
            "state_as_input": true
        },
        "dynamics": {
            "type": "Unicycle",
            "max_steer": 0.5,
            "max_yawvel": 6.283185307179586,
            "acce_bound": [
                -10,
                8
            ],
            "ddh_bound": [
                -6.283185307179586,
                6.283185307179586
            ],
            "max_speed": 40.0
        },
        "spatial_softmax": {
            "enabled": false,
            "kwargs": {
                "num_kp": 32,
                "temperature": 1.0,
                "learnable_temperature": false
            }
        },
        "loss_weights": {
            "prediction_loss": 1.0,
            "goal_loss": 0.0,
            "collision_loss": 0.0,
            "yaw_reg_loss": 0.1,
            "EC_coll_loss": 10,
            "deviation_loss": 0.5,
            "kl_loss": 1
        },
        "optim_params": {
            "policy": {
                "learning_rate": {
                    "initial": 0.001,
                    "decay_factor": 0.1,
                    "epoch_schedule": []
                },
                "regularization": {
                    "L2": 0.0
                }
            }
        },
        "goal_conditional": true,
        "goal_feature_dim": 32,
        "stage": 3,
        "num_frames_per_stage": 16,
        "vae": {
            "latent_dim": 4,
            "condition_dim": 128,
            "num_eval_samples": 10,
            "encoder": {
                "rnn_hidden_size": 100,
                "mlp_layer_dims": [
                    128,
                    128
                ]
            },
            "decoder": {
                "rnn_hidden_size": 100,
                "mlp_layer_dims": [
                    128,
                    128
                ],
                "Gaussian_var": true
            },
            "recon_loss_type": "NLL",
            "logpi_clamp": -6.0
        },
        "ego_conditioning": true,
        "EC_feat_dim": 64,
        "eval": {
            "mode": "sum"
        },
        "min_std": 0.1
    },
    "name": "test",
    "root_dir": "l5_rasterized_tree_vae_trained_models/",
    "seed": 1,
    "devices": {
        "num_gpus": 1
    }
}